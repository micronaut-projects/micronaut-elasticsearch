<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>Elasticsearch configuration</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/custom.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <link rel="stylesheet" href="../css/highlight/agate.css">
    <script src="../js/highlight.pack.js"></script>
    <script src="../js/guide.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../js/docs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
    <script type="text/javascript">
        function addJsClass(el) {
            var classes = document.body.className.split(" ");
            classes.push("js");
            document.body.className = classes.join(" ");
        }
    </script>

</head>

<body class="body" id="docs" onload="addJsClass();" onhashchange="highlightMenu()"><div style="background-color: color(display-p3 1 0.784 0.2);border-top: 1px solid #000;z-index: 999;font-weight: bold;position:fixed;bottom: 0;left: 0;width: 100%;height: 42px;font-family: -apple-system, 'Helvetica Neue', Helvetica, sans-serif;font-size: 25px;text-align:center;padding-top: 15px;">You are viewing documentation for an old version of <a style="color: #fff !important;" href="https://micronaut-projects.github.io/micronaut-elasticsearch/latest/guide/index.html">Micronaut Elasticsearch</a></div>


<div id="table-of-content-nav-link" class="desktop">
    <a title="Collapse/Open Table of contents" title="Hide Table of Contents" href="javascript:hideTableOfContents();" class="button">[ + ]</a>
</div>

<div id="main">
    <div id="navigation" class="no-print">
        <div class="navTitle">
            <span id="logo"><a href="http://micronaut.io" title="Go to Micronaut Website"><img src="../img/micronaut-logo-white.svg" alt="Micronaut"/></a></span>
        </div>
        <div class="navLinks">
            <ul>
                    <li>
                        <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)" class="desktop">
                            <a href="../guide/index.html" class="button">Table of contents</a>
                            <div id="nav-summary-childs" style="display:none;">
                                
                                <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#configuration"><strong>2</strong><span>Configuration</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#healthChecks"><strong>3</strong><span>Health Checks</span></a></div>
                                
                            </div>
                        </div>
                    </li>

                <li id="table-of-content-nav-link-mobile" class="mobile">
                    <a title="Scroll to Table of contents" href="javascript:scrollToTop();" class="button">Toc</a>
                </li>
                <li class="desktop">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API</a>
                </li>
                <li class="desktop">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Configuration Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Conf</a>
                </li>
            </ul>

        </div>
    </div>
    
    <div id="table-of-content">
        <div class="toc-content">

        <h2>Table of Contents</h2>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-introduction"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-configuration"><a href="#configuration"><strong>2</strong><span>Configuration</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-healthChecks"><a href="#healthChecks"><strong>3</strong><span>Health Checks</span></a></div>
        
        </div>
    </div>
    
    <div class="docs-content">
    <div class="project">
        <h1>Elasticsearch configuration</h1>
        <p></p>
        <p>Configuration to integrate Micronaut and Elasticsearch</p>
        <p><strong>Version:</strong> 1.0.0</p>
    </div>
    

<h1 id="introduction">1 Introduction</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-configuration-elasticsearch/edit/master/src/main/docs/guide/introduction.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut supports automatic configuration of Elasticsearch <a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/index.html" target="_blank">Java REST Client</a> via the <code>elasticsearch</code> module.</p>
</div>


<h1 id="configuration">2 Configuration</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-configuration-elasticsearch/edit/master/src/main/docs/guide/configuration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect1">
<h2 id="_configuring_the_elasticsearch_client">Configuring the Elasticsearch Client</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Using the CLI</div>
<div class="paragraph">
<p>If you are creating your project using the Micronaut CLI, supply the <code>elasticsearch</code> feature to configure the Elasticsearch Java REST Client in your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mn create-app my-app --features elasticsearch</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To configure the Elasticsearch Java REST Client you should first add <code>elasticsearch</code> module to your classpath:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">compile "io.micronaut.configuration:micronaut-elasticsearch"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should then configure the <code>httpHosts</code> of the Elasticsearch server you wish to communicate with in <code>application.yml</code> as:</p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml" data-lang="yaml">elasticsearch:
	httpHosts: "http://localhost:9200,http://127.0.0.2:9200"</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the API for api:configuration.mongo.reactive.DefaultElasticsearchConfigurationProperties[] for more information on the available configuration options.</p>
</div>
<div class="paragraph">
<p>Once you have the above configuration in place then you can inject the <code>org.elasticsearch.client.RestHighLevelClient</code> or <code>org.elasticsearch.client.RestClient</code> bean. The following is the simplest way to get Elasticsearch information using the High Level REST Client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">MainResponse response =
        client.info(RequestOptions.DEFAULT) <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>client</code> is an instance of the <code>org.elasticsearch.client.RestHighLevelClient</code> bean.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information on executing different operations using Elasticsearch High Level REST Client please read the <a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html" target="_blank">Elasticsearch Documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modify_the_default_request_configurations">Modify the Default Request Configurations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Often times you want to change the default configurations. To achieve this Micronaut, includes the ability to change the default request configurations. You can set the default request configurations under key <code>elasticsearch.request.default</code> as:</p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml" data-lang="yaml">elasticsearch:
	httpHosts: http://localhost:9200,http://127.0.0.2:9200
	request:
		default:
			expectContinueEnabled: true
			localAddress: 198.57.151.22</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the API <a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/config/RequestConfig.Builder.html" target="_blank">RequestConfig.Builder</a> for more information on the available configuration options.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modify_the_http_client_configurations">Modify the HTTP Client Configurations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To modify the HTTP Client configurations (e.g. request timeouts, authentication, or anything that the <a href="http://hc.apache.org/httpcomponents-asyncclient-dev/httpasyncclient/apidocs/org/apache/http/impl/nio/client/HttpAsyncClientBuilder.html" target="_blank">HttpAsyncClientBuilder</a> allows to set). You can define a bean using api:io.micronaut.context.annotation.Factory[] which replaces <code>org.apache.http.impl.nio.client.HttpAsyncClientBuilder</code>.</p>
</div>
<div class="paragraph">
<p>Following is an example to change the default credentials provider:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy" data-lang="groovy">import io.micronaut.context.annotation.Replaces
import org.apache.http.auth.AuthScope

@Factory
static class HttpAsyncClientBuilderFactory {

    @Replaces(HttpAsyncClientBuilder.class)
    @Singleton
    HttpAsyncClientBuilder builder() {
        final CredentialsProvider credentialsProvider = new BasicCredentialsProvider()
        credentialsProvider.setCredentials(AuthScope.ANY,
                new UsernamePasswordCredentials("user", "password"))

        return HttpAsyncClientBuilder.create()
                .setDefaultCredentialsProvider(credentialsProvider)
    }
}</code></pre>
</div>
</div>
</div>
</div>


<h1 id="healthChecks">3 Health Checks</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-configuration-elasticsearch/edit/master/src/main/docs/guide/healthChecks.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>When the <code>elasticsearch</code> module is activated a api:configuration.elasticsearch.health.ElasticsearchHealthIndicator[] is activated resulting in the <code>/health</code> endpoint and api:health.CurrentHealthStatus[] interface resolving the health of the Elasticsearch cluster.</p>
</div>
<div class="paragraph">
<p>The only configuration option supported is to enable or disable the indicator by the <code>endpoints.health.elasticsearch.enabled</code> key.</p>
</div>
<div class="paragraph">
<p>See the section on the <a href="https://docs.micronaut.io/latest/guide/index.html#healthEndpoint">Health Endpoint</a> for more information.</p>
</div>

    </div>
</div>

<script type="text/javascript">

</script>
</body>
</html>